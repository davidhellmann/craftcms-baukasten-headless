import {graphqlClient} from "../lib/graphql-client";
import {NewsDetailPage} from "../gql/news.detail.gql";
import Link from "next/link";

const getAllEntries = async (section: string[], cache: number = 3600) => {
  return await graphqlClient.request(`
    query getAllEntries($section: [String]!) {
      entries(section: $section) {
        title
        id
        slug
        uri
      }
    }
  `, {
    section,
    next: {
      revalidate: cache
    },
  })
}

const RootLayout = async ({children}: { children: React.ReactNode  }) => {
  const { entries } = await getAllEntries(['pages', 'home', 'news'])

  return (
    <html lang="en">
    <head>
      <title>Create Next App</title>
      <meta name="description" content="Generated by create next app" />
      <link rel="icon" href="/favicon.ico" />
    </head>
    <body>
      <aside>
        <h2>Aside</h2>
        <ul>
          {entries.map((entry: {
            uri: string;
            title: string;
          }) => {
            return (
              <>
                <li>
                  <Link href={entry.uri}>{entry.title}</Link>
                </li>
              </>
            )
          })}
        </ul>

      </aside>
      <main>
        {children}
      </main>
    </body>
    </html>
  )
}

export default RootLayout
